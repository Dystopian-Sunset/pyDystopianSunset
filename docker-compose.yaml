version: "3"

services:
  # discord-bot:
  #   build:
  #     context: .
  #     dockerfile: Docker/Containerfile
  #   restart: always
  #   volumes:
  #     - .:/app
  #     - /app/.venv
  #   # develop:
  #   #   watch:
  #   #     - action: sync
  #   #       path: .
  #   #       target: /app
  #   #       ignore:
  #   #         - .venv
  #   #         - .git
  #   #         - .containerignore
  #   #         - Docker/*
  #   #         - docker-compose.yaml
  #   #     - action: rebuild
  #   #       path: ./pyproject.toml
          

  # Backing Services
  dragonfly: # Redis Alternative - Valkey or KeyDB may be alternatives if DF is not suitable
    image: docker.dragonflydb.io/dragonflydb/dragonfly
    restart: on-failure
    ports:
      - "6379:6379"
    ulimits:
      memlock:
        soft: -1
        hard: -1
    volumes:
      - dragonfly:/data

  nats: # Kafka Alternative - https://hub.docker.com/_/nats/ for more configuration options
    image: docker.io/nats:latest
    restart: on-failure
    ports:
      - "4222:4222"
      - "6222:6222"
      - "8222:8222"
    volumes:
      - nats:/data

  surrealdb: # NewSQL Alternative - https://surrealdb.com/docs/surrealdb/installation/running/docker
    image: docker.io/surrealdb/surrealdb
    restart: on-failure
    ports:
      - "8000:8000"
    volumes:
      - surrealdb:/surrealdb
    command:
      - start
      - --user
      - root 
      - --pass
      - root

volumes:
  dragonfly:
  nats:
  surrealdb: